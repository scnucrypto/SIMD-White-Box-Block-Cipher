#ifndef WBAES_SE_LOCAL_H
#define WBAES_SE_LOCAL_H
#include "wbmatrix/WBMatrix.h"

static const uint8_t aes_sbox[256]={
    0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B,
    0xFE, 0xD7, 0xAB, 0x76, 0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0,
    0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0, 0xB7, 0xFD, 0x93, 0x26,
    0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15,
    0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2,
    0xEB, 0x27, 0xB2, 0x75, 0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0,
    0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84, 0x53, 0xD1, 0x00, 0xED,
    0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF,
    0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F,
    0x50, 0x3C, 0x9F, 0xA8, 0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5,
    0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2, 0xCD, 0x0C, 0x13, 0xEC,
    0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73,
    0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14,
    0xDE, 0x5E, 0x0B, 0xDB, 0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C,
    0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79, 0xE7, 0xC8, 0x37, 0x6D,
    0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08,
    0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F,
    0x4B, 0xBD, 0x8B, 0x8A, 0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E,
    0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E, 0xE1, 0xF8, 0x98, 0x11,
    0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF,
    0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F,
    0xB0, 0x54, 0xBB, 0x16
};

static const M128 L_matrix = {    
    .M[0][0] = 0x4000000000c00000, .M[0][1] = 0x800000000080,
    .M[1][0] = 0x2000000000600000, .M[1][1] = 0x400000000040,
    .M[2][0] = 0x1000000000300000, .M[2][1] = 0x200000000020,
    .M[3][0] = 0x8800000000980000, .M[3][1] = 0x100000000010,
    .M[4][0] = 0x84000000008c0000, .M[4][1] = 0x80000000008,
    .M[5][0] = 0x200000000060000, .M[5][1] = 0x40000000004,
    .M[6][0] = 0x8100000000830000, .M[6][1] = 0x20000000002,
    .M[7][0] = 0x8000000000810000, .M[7][1] = 0x10000000001,
    .M[8][0] = 0x8000000000400000, .M[8][1] = 0xc00000000080,
    .M[9][0] = 0x4000000000200000, .M[9][1] = 0x600000000040,
    .M[10][0] = 0x2000000000100000, .M[10][1] = 0x300000000020,
    .M[11][0] = 0x1000000000880000, .M[11][1] = 0x980000000010,
    .M[12][0] = 0x800000000840000, .M[12][1] = 0x8c0000000008,
    .M[13][0] = 0x400000000020000, .M[13][1] = 0x60000000004,
    .M[14][0] = 0x200000000810000, .M[14][1] = 0x830000000002,
    .M[15][0] = 0x100000000800000, .M[15][1] = 0x810000000001,
    .M[16][0] = 0x8000000000800000, .M[16][1] = 0x4000000000c0,
    .M[17][0] = 0x4000000000400000, .M[17][1] = 0x200000000060,
    .M[18][0] = 0x2000000000200000, .M[18][1] = 0x100000000030,
    .M[19][0] = 0x1000000000100000, .M[19][1] = 0x880000000098,
    .M[20][0] = 0x800000000080000, .M[20][1] = 0x84000000008c,
    .M[21][0] = 0x400000000040000, .M[21][1] = 0x20000000006,
    .M[22][0] = 0x200000000020000, .M[22][1] = 0x810000000083,
    .M[23][0] = 0x100000000010000, .M[23][1] = 0x800000000081,
    .M[24][0] = 0xc000000000800000, .M[24][1] = 0x800000000040,
    .M[25][0] = 0x6000000000400000, .M[25][1] = 0x400000000020,
    .M[26][0] = 0x3000000000200000, .M[26][1] = 0x200000000010,
    .M[27][0] = 0x9800000000100000, .M[27][1] = 0x100000000088,
    .M[28][0] = 0x8c00000000080000, .M[28][1] = 0x80000000084,
    .M[29][0] = 0x600000000040000, .M[29][1] = 0x40000000002,
    .M[30][0] = 0x8300000000020000, .M[30][1] = 0x20000000081,
    .M[31][0] = 0x8100000000010000, .M[31][1] = 0x10000000080,
    .M[32][0] = 0x8040000000, .M[32][1] = 0xc0000000008000,
    .M[33][0] = 0x4020000000, .M[33][1] = 0x60000000004000,
    .M[34][0] = 0x2010000000, .M[34][1] = 0x30000000002000,
    .M[35][0] = 0x1088000000, .M[35][1] = 0x98000000001000,
    .M[36][0] = 0x884000000, .M[36][1] = 0x8c000000000800,
    .M[37][0] = 0x402000000, .M[37][1] = 0x6000000000400,
    .M[38][0] = 0x281000000, .M[38][1] = 0x83000000000200,
    .M[39][0] = 0x180000000, .M[39][1] = 0x81000000000100,
    .M[40][0] = 0x8080000000, .M[40][1] = 0x4000000000c000,
    .M[41][0] = 0x4040000000, .M[41][1] = 0x20000000006000,
    .M[42][0] = 0x2020000000, .M[42][1] = 0x10000000003000,
    .M[43][0] = 0x1010000000, .M[43][1] = 0x88000000009800,
    .M[44][0] = 0x808000000, .M[44][1] = 0x84000000008c00,
    .M[45][0] = 0x404000000, .M[45][1] = 0x2000000000600,
    .M[46][0] = 0x202000000, .M[46][1] = 0x81000000008300,
    .M[47][0] = 0x101000000, .M[47][1] = 0x80000000008100,
    .M[48][0] = 0xc080000000, .M[48][1] = 0x80000000004000,
    .M[49][0] = 0x6040000000, .M[49][1] = 0x40000000002000,
    .M[50][0] = 0x3020000000, .M[50][1] = 0x20000000001000,
    .M[51][0] = 0x9810000000, .M[51][1] = 0x10000000008800,
    .M[52][0] = 0x8c08000000, .M[52][1] = 0x8000000008400,
    .M[53][0] = 0x604000000, .M[53][1] = 0x4000000000200,
    .M[54][0] = 0x8302000000, .M[54][1] = 0x2000000008100,
    .M[55][0] = 0x8101000000, .M[55][1] = 0x1000000008000,
    .M[56][0] = 0x40c0000000, .M[56][1] = 0x80000000008000,
    .M[57][0] = 0x2060000000, .M[57][1] = 0x40000000004000,
    .M[58][0] = 0x1030000000, .M[58][1] = 0x20000000002000,
    .M[59][0] = 0x8898000000, .M[59][1] = 0x10000000001000,
    .M[60][0] = 0x848c000000, .M[60][1] = 0x8000000000800,
    .M[61][0] = 0x206000000, .M[61][1] = 0x4000000000400,
    .M[62][0] = 0x8183000000, .M[62][1] = 0x2000000000200,
    .M[63][0] = 0x8081000000, .M[63][1] = 0x1000000000100,
    .M[64][0] = 0x800000000080, .M[64][1] = 0x4000000000c00000,
    .M[65][0] = 0x400000000040, .M[65][1] = 0x2000000000600000,
    .M[66][0] = 0x200000000020, .M[66][1] = 0x1000000000300000,
    .M[67][0] = 0x100000000010, .M[67][1] = 0x8800000000980000,
    .M[68][0] = 0x80000000008, .M[68][1] = 0x84000000008c0000,
    .M[69][0] = 0x40000000004, .M[69][1] = 0x200000000060000,
    .M[70][0] = 0x20000000002, .M[70][1] = 0x8100000000830000,
    .M[71][0] = 0x10000000001, .M[71][1] = 0x8000000000810000,
    .M[72][0] = 0xc00000000080, .M[72][1] = 0x8000000000400000,
    .M[73][0] = 0x600000000040, .M[73][1] = 0x4000000000200000,
    .M[74][0] = 0x300000000020, .M[74][1] = 0x2000000000100000,
    .M[75][0] = 0x980000000010, .M[75][1] = 0x1000000000880000,
    .M[76][0] = 0x8c0000000008, .M[76][1] = 0x800000000840000,
    .M[77][0] = 0x60000000004, .M[77][1] = 0x400000000020000,
    .M[78][0] = 0x830000000002, .M[78][1] = 0x200000000810000,
    .M[79][0] = 0x810000000001, .M[79][1] = 0x100000000800000,
    .M[80][0] = 0x4000000000c0, .M[80][1] = 0x8000000000800000,
    .M[81][0] = 0x200000000060, .M[81][1] = 0x4000000000400000,
    .M[82][0] = 0x100000000030, .M[82][1] = 0x2000000000200000,
    .M[83][0] = 0x880000000098, .M[83][1] = 0x1000000000100000,
    .M[84][0] = 0x84000000008c, .M[84][1] = 0x800000000080000,
    .M[85][0] = 0x20000000006, .M[85][1] = 0x400000000040000,
    .M[86][0] = 0x810000000083, .M[86][1] = 0x200000000020000,
    .M[87][0] = 0x800000000081, .M[87][1] = 0x100000000010000,
    .M[88][0] = 0x800000000040, .M[88][1] = 0xc000000000800000,
    .M[89][0] = 0x400000000020, .M[89][1] = 0x6000000000400000,
    .M[90][0] = 0x200000000010, .M[90][1] = 0x3000000000200000,
    .M[91][0] = 0x100000000088, .M[91][1] = 0x9800000000100000,
    .M[92][0] = 0x80000000084, .M[92][1] = 0x8c00000000080000,
    .M[93][0] = 0x40000000002, .M[93][1] = 0x600000000040000,
    .M[94][0] = 0x20000000081, .M[94][1] = 0x8300000000020000,
    .M[95][0] = 0x10000000080, .M[95][1] = 0x8100000000010000,
    .M[96][0] = 0xc0000000008000, .M[96][1] = 0x8040000000,
    .M[97][0] = 0x60000000004000, .M[97][1] = 0x4020000000,
    .M[98][0] = 0x30000000002000, .M[98][1] = 0x2010000000,
    .M[99][0] = 0x98000000001000, .M[99][1] = 0x1088000000,
    .M[100][0] = 0x8c000000000800, .M[100][1] = 0x884000000,
    .M[101][0] = 0x6000000000400, .M[101][1] = 0x402000000,
    .M[102][0] = 0x83000000000200, .M[102][1] = 0x281000000,
    .M[103][0] = 0x81000000000100, .M[103][1] = 0x180000000,
    .M[104][0] = 0x4000000000c000, .M[104][1] = 0x8080000000,
    .M[105][0] = 0x20000000006000, .M[105][1] = 0x4040000000,
    .M[106][0] = 0x10000000003000, .M[106][1] = 0x2020000000,
    .M[107][0] = 0x88000000009800, .M[107][1] = 0x1010000000,
    .M[108][0] = 0x84000000008c00, .M[108][1] = 0x808000000,
    .M[109][0] = 0x2000000000600, .M[109][1] = 0x404000000,
    .M[110][0] = 0x81000000008300, .M[110][1] = 0x202000000,
    .M[111][0] = 0x80000000008100, .M[111][1] = 0x101000000,
    .M[112][0] = 0x80000000004000, .M[112][1] = 0xc080000000,
    .M[113][0] = 0x40000000002000, .M[113][1] = 0x6040000000,
    .M[114][0] = 0x20000000001000, .M[114][1] = 0x3020000000,
    .M[115][0] = 0x10000000008800, .M[115][1] = 0x9810000000,
    .M[116][0] = 0x8000000008400, .M[116][1] = 0x8c08000000,
    .M[117][0] = 0x4000000000200, .M[117][1] = 0x604000000,
    .M[118][0] = 0x2000000008100, .M[118][1] = 0x8302000000,
    .M[119][0] = 0x1000000008000, .M[119][1] = 0x8101000000,
    .M[120][0] = 0x80000000008000, .M[120][1] = 0x40c0000000,
    .M[121][0] = 0x40000000004000, .M[121][1] = 0x2060000000,
    .M[122][0] = 0x20000000002000, .M[122][1] = 0x1030000000,
    .M[123][0] = 0x10000000001000, .M[123][1] = 0x8898000000,
    .M[124][0] = 0x8000000000800, .M[124][1] = 0x848c000000,
    .M[125][0] = 0x4000000000400, .M[125][1] = 0x206000000,
    .M[126][0] = 0x2000000000200, .M[126][1] = 0x8183000000,
    .M[127][0] = 0x1000000000100, .M[127][1] = 0x8081000000,
};
static const M128 shiftrows = { 
    .M[0][0] = 0x8000000000000000, .M[0][1] = 0x0,
    .M[1][0] = 0x4000000000000000, .M[1][1] = 0x0,
    .M[2][0] = 0x2000000000000000, .M[2][1] = 0x0,
    .M[3][0] = 0x1000000000000000, .M[3][1] = 0x0,
    .M[4][0] = 0x800000000000000, .M[4][1] = 0x0,
    .M[5][0] = 0x400000000000000, .M[5][1] = 0x0,
    .M[6][0] = 0x200000000000000, .M[6][1] = 0x0,
    .M[7][0] = 0x100000000000000, .M[7][1] = 0x0,
    .M[8][0] = 0x800000, .M[8][1] = 0x0,
    .M[9][0] = 0x400000, .M[9][1] = 0x0,
    .M[10][0] = 0x200000, .M[10][1] = 0x0,
    .M[11][0] = 0x100000, .M[11][1] = 0x0,
    .M[12][0] = 0x80000, .M[12][1] = 0x0,
    .M[13][0] = 0x40000, .M[13][1] = 0x0,
    .M[14][0] = 0x20000, .M[14][1] = 0x0,
    .M[15][0] = 0x10000, .M[15][1] = 0x0,
    .M[16][0] = 0x0, .M[16][1] = 0x800000000000,
    .M[17][0] = 0x0, .M[17][1] = 0x400000000000,
    .M[18][0] = 0x0, .M[18][1] = 0x200000000000,
    .M[19][0] = 0x0, .M[19][1] = 0x100000000000,
    .M[20][0] = 0x0, .M[20][1] = 0x80000000000,
    .M[21][0] = 0x0, .M[21][1] = 0x40000000000,
    .M[22][0] = 0x0, .M[22][1] = 0x20000000000,
    .M[23][0] = 0x0, .M[23][1] = 0x10000000000,
    .M[24][0] = 0x0, .M[24][1] = 0x80,
    .M[25][0] = 0x0, .M[25][1] = 0x40,
    .M[26][0] = 0x0, .M[26][1] = 0x20,
    .M[27][0] = 0x0, .M[27][1] = 0x10,
    .M[28][0] = 0x0, .M[28][1] = 0x8,
    .M[29][0] = 0x0, .M[29][1] = 0x4,
    .M[30][0] = 0x0, .M[30][1] = 0x2,
    .M[31][0] = 0x0, .M[31][1] = 0x1,
    .M[32][0] = 0x80000000, .M[32][1] = 0x0,
    .M[33][0] = 0x40000000, .M[33][1] = 0x0,
    .M[34][0] = 0x20000000, .M[34][1] = 0x0,
    .M[35][0] = 0x10000000, .M[35][1] = 0x0,
    .M[36][0] = 0x8000000, .M[36][1] = 0x0,
    .M[37][0] = 0x4000000, .M[37][1] = 0x0,
    .M[38][0] = 0x2000000, .M[38][1] = 0x0,
    .M[39][0] = 0x1000000, .M[39][1] = 0x0,
    .M[40][0] = 0x0, .M[40][1] = 0x80000000000000,
    .M[41][0] = 0x0, .M[41][1] = 0x40000000000000,
    .M[42][0] = 0x0, .M[42][1] = 0x20000000000000,
    .M[43][0] = 0x0, .M[43][1] = 0x10000000000000,
    .M[44][0] = 0x0, .M[44][1] = 0x8000000000000,
    .M[45][0] = 0x0, .M[45][1] = 0x4000000000000,
    .M[46][0] = 0x0, .M[46][1] = 0x2000000000000,
    .M[47][0] = 0x0, .M[47][1] = 0x1000000000000,
    .M[48][0] = 0x0, .M[48][1] = 0x8000,
    .M[49][0] = 0x0, .M[49][1] = 0x4000,
    .M[50][0] = 0x0, .M[50][1] = 0x2000,
    .M[51][0] = 0x0, .M[51][1] = 0x1000,
    .M[52][0] = 0x0, .M[52][1] = 0x800,
    .M[53][0] = 0x0, .M[53][1] = 0x400,
    .M[54][0] = 0x0, .M[54][1] = 0x200,
    .M[55][0] = 0x0, .M[55][1] = 0x100,
    .M[56][0] = 0x8000000000, .M[56][1] = 0x0,
    .M[57][0] = 0x4000000000, .M[57][1] = 0x0,
    .M[58][0] = 0x2000000000, .M[58][1] = 0x0,
    .M[59][0] = 0x1000000000, .M[59][1] = 0x0,
    .M[60][0] = 0x800000000, .M[60][1] = 0x0,
    .M[61][0] = 0x400000000, .M[61][1] = 0x0,
    .M[62][0] = 0x200000000, .M[62][1] = 0x0,
    .M[63][0] = 0x100000000, .M[63][1] = 0x0,
    .M[64][0] = 0x0, .M[64][1] = 0x8000000000000000,
    .M[65][0] = 0x0, .M[65][1] = 0x4000000000000000,
    .M[66][0] = 0x0, .M[66][1] = 0x2000000000000000,
    .M[67][0] = 0x0, .M[67][1] = 0x1000000000000000,
    .M[68][0] = 0x0, .M[68][1] = 0x800000000000000,
    .M[69][0] = 0x0, .M[69][1] = 0x400000000000000,
    .M[70][0] = 0x0, .M[70][1] = 0x200000000000000,
    .M[71][0] = 0x0, .M[71][1] = 0x100000000000000,
    .M[72][0] = 0x0, .M[72][1] = 0x800000,
    .M[73][0] = 0x0, .M[73][1] = 0x400000,
    .M[74][0] = 0x0, .M[74][1] = 0x200000,
    .M[75][0] = 0x0, .M[75][1] = 0x100000,
    .M[76][0] = 0x0, .M[76][1] = 0x80000,
    .M[77][0] = 0x0, .M[77][1] = 0x40000,
    .M[78][0] = 0x0, .M[78][1] = 0x20000,
    .M[79][0] = 0x0, .M[79][1] = 0x10000,
    .M[80][0] = 0x800000000000, .M[80][1] = 0x0,
    .M[81][0] = 0x400000000000, .M[81][1] = 0x0,
    .M[82][0] = 0x200000000000, .M[82][1] = 0x0,
    .M[83][0] = 0x100000000000, .M[83][1] = 0x0,
    .M[84][0] = 0x80000000000, .M[84][1] = 0x0,
    .M[85][0] = 0x40000000000, .M[85][1] = 0x0,
    .M[86][0] = 0x20000000000, .M[86][1] = 0x0,
    .M[87][0] = 0x10000000000, .M[87][1] = 0x0,
    .M[88][0] = 0x80, .M[88][1] = 0x0,
    .M[89][0] = 0x40, .M[89][1] = 0x0,
    .M[90][0] = 0x20, .M[90][1] = 0x0,
    .M[91][0] = 0x10, .M[91][1] = 0x0,
    .M[92][0] = 0x8, .M[92][1] = 0x0,
    .M[93][0] = 0x4, .M[93][1] = 0x0,
    .M[94][0] = 0x2, .M[94][1] = 0x0,
    .M[95][0] = 0x1, .M[95][1] = 0x0,
    .M[96][0] = 0x0, .M[96][1] = 0x80000000,
    .M[97][0] = 0x0, .M[97][1] = 0x40000000,
    .M[98][0] = 0x0, .M[98][1] = 0x20000000,
    .M[99][0] = 0x0, .M[99][1] = 0x10000000,
    .M[100][0] = 0x0, .M[100][1] = 0x8000000,
    .M[101][0] = 0x0, .M[101][1] = 0x4000000,
    .M[102][0] = 0x0, .M[102][1] = 0x2000000,
    .M[103][0] = 0x0, .M[103][1] = 0x1000000,
    .M[104][0] = 0x80000000000000, .M[104][1] = 0x0,
    .M[105][0] = 0x40000000000000, .M[105][1] = 0x0,
    .M[106][0] = 0x20000000000000, .M[106][1] = 0x0,
    .M[107][0] = 0x10000000000000, .M[107][1] = 0x0,
    .M[108][0] = 0x8000000000000, .M[108][1] = 0x0,
    .M[109][0] = 0x4000000000000, .M[109][1] = 0x0,
    .M[110][0] = 0x2000000000000, .M[110][1] = 0x0,
    .M[111][0] = 0x1000000000000, .M[111][1] = 0x0,
    .M[112][0] = 0x8000, .M[112][1] = 0x0,
    .M[113][0] = 0x4000, .M[113][1] = 0x0,
    .M[114][0] = 0x2000, .M[114][1] = 0x0,
    .M[115][0] = 0x1000, .M[115][1] = 0x0,
    .M[116][0] = 0x800, .M[116][1] = 0x0,
    .M[117][0] = 0x400, .M[117][1] = 0x0,
    .M[118][0] = 0x200, .M[118][1] = 0x0,
    .M[119][0] = 0x100, .M[119][1] = 0x0,
    .M[120][0] = 0x0, .M[120][1] = 0x8000000000,
    .M[121][0] = 0x0, .M[121][1] = 0x4000000000,
    .M[122][0] = 0x0, .M[122][1] = 0x2000000000,
    .M[123][0] = 0x0, .M[123][1] = 0x1000000000,
    .M[124][0] = 0x0, .M[124][1] = 0x800000000,
    .M[125][0] = 0x0, .M[125][1] = 0x400000000,
    .M[126][0] = 0x0, .M[126][1] = 0x200000000,
    .M[127][0] = 0x0, .M[127][1] = 0x100000000,
};

void SE_initial(Aff8 A[2039],Aff8 B[2039]);
#define GET64(pc)  (\
((uint64_t)(pc)[0] << 56) ^\
((uint64_t)(pc)[1] << 48) ^\
((uint64_t)(pc)[2] << 40) ^\
((uint64_t)(pc)[3] << 32) ^\
((uint64_t)(pc)[4] << 24) ^\
((uint64_t)(pc)[5] << 16) ^\
((uint64_t)(pc)[6] << 8) ^\
((uint64_t)(pc)[7]))

// todo 已修改
#define PUT64(st, ct)\
(ct)[0] = (uint8_t)((st) >> 56);\
(ct)[1] = (uint8_t)((st) >> 48);\
(ct)[2] = (uint8_t)((st) >> 40);\
(ct)[3] = (uint8_t)((st) >> 32);\
(ct)[4] = (uint8_t)((st) >> 24);\
(ct)[5] = (uint8_t)((st) >> 16);\
(ct)[6] = (uint8_t)((st) >>  8);\
(ct)[7] = (uint8_t)(st)




static const uint32_t T3[256] = {
        0x63000000, 0x7c000000, 0x77000000, 0x7b000000, 0xf2000000, 0x6b000000, 
        0x6f000000, 0xc5000000, 0x30000000, 0x1000000, 0x67000000, 0x2b000000, 
        0xfe000000, 0xd7000000, 0xab000000, 0x76000000, 0xca000000, 0x82000000, 
        0xc9000000, 0x7d000000, 0xfa000000, 0x59000000, 0x47000000, 0xf0000000, 
        0xad000000, 0xd4000000, 0xa2000000, 0xaf000000, 0x9c000000, 0xa4000000, 
        0x72000000, 0xc0000000, 0xb7000000, 0xfd000000, 0x93000000, 0x26000000, 
        0x36000000, 0x3f000000, 0xf7000000, 0xcc000000, 0x34000000, 0xa5000000, 
        0xe5000000, 0xf1000000, 0x71000000, 0xd8000000, 0x31000000, 0x15000000, 
        0x4000000, 0xc7000000, 0x23000000, 0xc3000000, 0x18000000, 0x96000000, 
        0x5000000, 0x9a000000, 0x7000000, 0x12000000, 0x80000000, 0xe2000000, 
        0xeb000000, 0x27000000, 0xb2000000, 0x75000000, 0x9000000, 0x83000000, 
        0x2c000000, 0x1a000000, 0x1b000000, 0x6e000000, 0x5a000000, 0xa0000000, 
        0x52000000, 0x3b000000, 0xd6000000, 0xb3000000, 0x29000000, 0xe3000000, 
        0x2f000000, 0x84000000, 0x53000000, 0xd1000000, 0x0, 0xed000000, 
        0x20000000, 0xfc000000, 0xb1000000, 0x5b000000, 0x6a000000, 0xcb000000, 
        0xbe000000, 0x39000000, 0x4a000000, 0x4c000000, 0x58000000, 0xcf000000, 
        0xd0000000, 0xef000000, 0xaa000000, 0xfb000000, 0x43000000, 0x4d000000, 
        0x33000000, 0x85000000, 0x45000000, 0xf9000000, 0x2000000, 0x7f000000, 
        0x50000000, 0x3c000000, 0x9f000000, 0xa8000000, 0x51000000, 0xa3000000, 
        0x40000000, 0x8f000000, 0x92000000, 0x9d000000, 0x38000000, 0xf5000000, 
        0xbc000000, 0xb6000000, 0xda000000, 0x21000000, 0x10000000, 0xff000000, 
        0xf3000000, 0xd2000000, 0xcd000000, 0xc000000, 0x13000000, 0xec000000, 
        0x5f000000, 0x97000000, 0x44000000, 0x17000000, 0xc4000000, 0xa7000000, 
        0x7e000000, 0x3d000000, 0x64000000, 0x5d000000, 0x19000000, 0x73000000, 
        0x60000000, 0x81000000, 0x4f000000, 0xdc000000, 0x22000000, 0x2a000000, 
        0x90000000, 0x88000000, 0x46000000, 0xee000000, 0xb8000000, 0x14000000, 
        0xde000000, 0x5e000000, 0xb000000, 0xdb000000, 0xe0000000, 0x32000000, 
        0x3a000000, 0xa000000, 0x49000000, 0x6000000, 0x24000000, 0x5c000000, 
        0xc2000000, 0xd3000000, 0xac000000, 0x62000000, 0x91000000, 0x95000000, 
        0xe4000000, 0x79000000, 0xe7000000, 0xc8000000, 0x37000000, 0x6d000000, 
        0x8d000000, 0xd5000000, 0x4e000000, 0xa9000000, 0x6c000000, 0x56000000, 
        0xf4000000, 0xea000000, 0x65000000, 0x7a000000, 0xae000000, 0x8000000, 
        0xba000000, 0x78000000, 0x25000000, 0x2e000000, 0x1c000000, 0xa6000000, 
        0xb4000000, 0xc6000000, 0xe8000000, 0xdd000000, 0x74000000, 0x1f000000, 
        0x4b000000, 0xbd000000, 0x8b000000, 0x8a000000, 0x70000000, 0x3e000000, 
        0xb5000000, 0x66000000, 0x48000000, 0x3000000, 0xf6000000, 0xe000000, 
        0x61000000, 0x35000000, 0x57000000, 0xb9000000, 0x86000000, 0xc1000000, 
        0x1d000000, 0x9e000000, 0xe1000000, 0xf8000000, 0x98000000, 0x11000000, 
        0x69000000, 0xd9000000, 0x8e000000, 0x94000000, 0x9b000000, 0x1e000000, 
        0x87000000, 0xe9000000, 0xce000000, 0x55000000, 0x28000000, 0xdf000000, 
        0x8c000000, 0xa1000000, 0x89000000, 0xd000000, 0xbf000000, 0xe6000000, 
        0x42000000, 0x68000000, 0x41000000, 0x99000000, 0x2d000000, 0xf000000, 
        0xb0000000, 0x54000000, 0xbb000000, 0x16000000,
    };
    static const uint32_t T2[256] = {
        0x630000, 0x7c0000, 0x770000, 0x7b0000, 0xf20000, 0x6b0000, 
        0x6f0000, 0xc50000, 0x300000, 0x10000, 0x670000, 0x2b0000, 
        0xfe0000, 0xd70000, 0xab0000, 0x760000, 0xca0000, 0x820000, 
        0xc90000, 0x7d0000, 0xfa0000, 0x590000, 0x470000, 0xf00000, 
        0xad0000, 0xd40000, 0xa20000, 0xaf0000, 0x9c0000, 0xa40000, 
        0x720000, 0xc00000, 0xb70000, 0xfd0000, 0x930000, 0x260000, 
        0x360000, 0x3f0000, 0xf70000, 0xcc0000, 0x340000, 0xa50000, 
        0xe50000, 0xf10000, 0x710000, 0xd80000, 0x310000, 0x150000, 
        0x40000, 0xc70000, 0x230000, 0xc30000, 0x180000, 0x960000, 
        0x50000, 0x9a0000, 0x70000, 0x120000, 0x800000, 0xe20000, 
        0xeb0000, 0x270000, 0xb20000, 0x750000, 0x90000, 0x830000, 
        0x2c0000, 0x1a0000, 0x1b0000, 0x6e0000, 0x5a0000, 0xa00000, 
        0x520000, 0x3b0000, 0xd60000, 0xb30000, 0x290000, 0xe30000, 
        0x2f0000, 0x840000, 0x530000, 0xd10000, 0x0, 0xed0000, 
        0x200000, 0xfc0000, 0xb10000, 0x5b0000, 0x6a0000, 0xcb0000, 
        0xbe0000, 0x390000, 0x4a0000, 0x4c0000, 0x580000, 0xcf0000, 
        0xd00000, 0xef0000, 0xaa0000, 0xfb0000, 0x430000, 0x4d0000, 
        0x330000, 0x850000, 0x450000, 0xf90000, 0x20000, 0x7f0000, 
        0x500000, 0x3c0000, 0x9f0000, 0xa80000, 0x510000, 0xa30000, 
        0x400000, 0x8f0000, 0x920000, 0x9d0000, 0x380000, 0xf50000, 
        0xbc0000, 0xb60000, 0xda0000, 0x210000, 0x100000, 0xff0000, 
        0xf30000, 0xd20000, 0xcd0000, 0xc0000, 0x130000, 0xec0000, 
        0x5f0000, 0x970000, 0x440000, 0x170000, 0xc40000, 0xa70000, 
        0x7e0000, 0x3d0000, 0x640000, 0x5d0000, 0x190000, 0x730000, 
        0x600000, 0x810000, 0x4f0000, 0xdc0000, 0x220000, 0x2a0000, 
        0x900000, 0x880000, 0x460000, 0xee0000, 0xb80000, 0x140000, 
        0xde0000, 0x5e0000, 0xb0000, 0xdb0000, 0xe00000, 0x320000, 
        0x3a0000, 0xa0000, 0x490000, 0x60000, 0x240000, 0x5c0000, 
        0xc20000, 0xd30000, 0xac0000, 0x620000, 0x910000, 0x950000, 
        0xe40000, 0x790000, 0xe70000, 0xc80000, 0x370000, 0x6d0000, 
        0x8d0000, 0xd50000, 0x4e0000, 0xa90000, 0x6c0000, 0x560000, 
        0xf40000, 0xea0000, 0x650000, 0x7a0000, 0xae0000, 0x80000, 
        0xba0000, 0x780000, 0x250000, 0x2e0000, 0x1c0000, 0xa60000, 
        0xb40000, 0xc60000, 0xe80000, 0xdd0000, 0x740000, 0x1f0000, 
        0x4b0000, 0xbd0000, 0x8b0000, 0x8a0000, 0x700000, 0x3e0000, 
        0xb50000, 0x660000, 0x480000, 0x30000, 0xf60000, 0xe0000, 
        0x610000, 0x350000, 0x570000, 0xb90000, 0x860000, 0xc10000, 
        0x1d0000, 0x9e0000, 0xe10000, 0xf80000, 0x980000, 0x110000, 
        0x690000, 0xd90000, 0x8e0000, 0x940000, 0x9b0000, 0x1e0000, 
        0x870000, 0xe90000, 0xce0000, 0x550000, 0x280000, 0xdf0000, 
        0x8c0000, 0xa10000, 0x890000, 0xd0000, 0xbf0000, 0xe60000, 
        0x420000, 0x680000, 0x410000, 0x990000, 0x2d0000, 0xf0000, 
        0xb00000, 0x540000, 0xbb0000, 0x160000,
    };
    static const uint32_t T1[256] = {
        0x6300, 0x7c00, 0x7700, 0x7b00, 0xf200, 0x6b00, 
        0x6f00, 0xc500, 0x3000, 0x100, 0x6700, 0x2b00, 
        0xfe00, 0xd700, 0xab00, 0x7600, 0xca00, 0x8200, 
        0xc900, 0x7d00, 0xfa00, 0x5900, 0x4700, 0xf000, 
        0xad00, 0xd400, 0xa200, 0xaf00, 0x9c00, 0xa400, 
        0x7200, 0xc000, 0xb700, 0xfd00, 0x9300, 0x2600, 
        0x3600, 0x3f00, 0xf700, 0xcc00, 0x3400, 0xa500, 
        0xe500, 0xf100, 0x7100, 0xd800, 0x3100, 0x1500, 
        0x400, 0xc700, 0x2300, 0xc300, 0x1800, 0x9600, 
        0x500, 0x9a00, 0x700, 0x1200, 0x8000, 0xe200, 
        0xeb00, 0x2700, 0xb200, 0x7500, 0x900, 0x8300, 
        0x2c00, 0x1a00, 0x1b00, 0x6e00, 0x5a00, 0xa000, 
        0x5200, 0x3b00, 0xd600, 0xb300, 0x2900, 0xe300, 
        0x2f00, 0x8400, 0x5300, 0xd100, 0x0, 0xed00, 
        0x2000, 0xfc00, 0xb100, 0x5b00, 0x6a00, 0xcb00, 
        0xbe00, 0x3900, 0x4a00, 0x4c00, 0x5800, 0xcf00, 
        0xd000, 0xef00, 0xaa00, 0xfb00, 0x4300, 0x4d00, 
        0x3300, 0x8500, 0x4500, 0xf900, 0x200, 0x7f00, 
        0x5000, 0x3c00, 0x9f00, 0xa800, 0x5100, 0xa300, 
        0x4000, 0x8f00, 0x9200, 0x9d00, 0x3800, 0xf500, 
        0xbc00, 0xb600, 0xda00, 0x2100, 0x1000, 0xff00, 
        0xf300, 0xd200, 0xcd00, 0xc00, 0x1300, 0xec00, 
        0x5f00, 0x9700, 0x4400, 0x1700, 0xc400, 0xa700, 
        0x7e00, 0x3d00, 0x6400, 0x5d00, 0x1900, 0x7300, 
        0x6000, 0x8100, 0x4f00, 0xdc00, 0x2200, 0x2a00, 
        0x9000, 0x8800, 0x4600, 0xee00, 0xb800, 0x1400, 
        0xde00, 0x5e00, 0xb00, 0xdb00, 0xe000, 0x3200, 
        0x3a00, 0xa00, 0x4900, 0x600, 0x2400, 0x5c00, 
        0xc200, 0xd300, 0xac00, 0x6200, 0x9100, 0x9500, 
        0xe400, 0x7900, 0xe700, 0xc800, 0x3700, 0x6d00, 
        0x8d00, 0xd500, 0x4e00, 0xa900, 0x6c00, 0x5600, 
        0xf400, 0xea00, 0x6500, 0x7a00, 0xae00, 0x800, 
        0xba00, 0x7800, 0x2500, 0x2e00, 0x1c00, 0xa600, 
        0xb400, 0xc600, 0xe800, 0xdd00, 0x7400, 0x1f00, 
        0x4b00, 0xbd00, 0x8b00, 0x8a00, 0x7000, 0x3e00, 
        0xb500, 0x6600, 0x4800, 0x300, 0xf600, 0xe00, 
        0x6100, 0x3500, 0x5700, 0xb900, 0x8600, 0xc100, 
        0x1d00, 0x9e00, 0xe100, 0xf800, 0x9800, 0x1100, 
        0x6900, 0xd900, 0x8e00, 0x9400, 0x9b00, 0x1e00, 
        0x8700, 0xe900, 0xce00, 0x5500, 0x2800, 0xdf00, 
        0x8c00, 0xa100, 0x8900, 0xd00, 0xbf00, 0xe600, 
        0x4200, 0x6800, 0x4100, 0x9900, 0x2d00, 0xf00, 
        0xb000, 0x5400, 0xbb00, 0x1600,
    };
    static const uint32_t T0[256] = {
        0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76,
        0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0,
        0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15,
        0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75,
        0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84,
        0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf,
        0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8,
        0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2,
        0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73,
        0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb,
        0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79,
        0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08,
        0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a,
        0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e,
        0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf,
        0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16
    };
#endif
